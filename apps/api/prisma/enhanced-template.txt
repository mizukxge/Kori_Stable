// ========================================
// ENHANCED CONTRACT TEMPLATE MODEL
// Replace existing model ContractTemplate with this
// ========================================

model ContractTemplate {
  id          String  @id @default(cuid())
  name        String  @unique
  slug        String  @unique
  description String?
  
  // Document classification
  documentType DocumentType @default(SERVICE_AGREEMENT)
  
  // Template structure (ENHANCED)
  content     String  @db.Text // Template content with {{variables}}
  headerHtml  String? @db.Text // Optional custom header
  footerHtml  String? @db.Text // Optional custom footer
  
  // Variables metadata (ENHANCED)
  variables Json? // JSON Schema: {client_name: {type: "string", required: true, label: "Client Name"}}
  
  // Clause references (NEW)
  clauseIds String[] // Array of Clause IDs to include
  
  // Status
  isActive    Boolean @default(true)
  isPublished Boolean @default(false)
  publishedAt DateTime?
  version     Int     @default(1)
  
  // Relations
  contracts    Contract[]
  pricingRules PricingRule[]
  
  createdBy     String
  createdByUser AdminUser @relation(fields: [createdBy], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@index([name])
  @@index([slug])
  @@index([documentType])
  @@index([isPublished])
  @@map("contract_templates")
}